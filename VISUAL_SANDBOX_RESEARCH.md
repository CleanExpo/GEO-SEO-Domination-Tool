# Visual Sandbox Research - Open Source Models

## Research Date: 2025-10-06

### Objective
Find open-source PWA Visual Sandbox models compatible with Next.js/Vite to enhance the MetaCoder Sandbox project.

---

## Top Open-Source Projects

### 1. ⭐ **E2B Fragments** (RECOMMENDED)
**GitHub**: https://github.com/e2b-dev/fragments

**Description**: Open-source Next.js template for building apps that are fully generated by AI

**Key Features**:
- ✅ Streaming UI generation
- ✅ Secure code execution via E2B SDK
- ✅ NPM and pip package installation
- ✅ Real-time code preview
- ✅ Multi-language support (JavaScript, Python)
- ✅ Built with Next.js 15 (matches our stack)

**Why Recommended for MetaCoder**:
- Compatible with our Next.js 15 setup
- E2B SDK provides secure sandboxed execution (better than direct Vercel Sandbox)
- Supports streaming AI responses (works with Claude Code)
- Production-ready architecture
- Active development and community

**Integration Plan**:
1. Add E2B SDK to project dependencies
2. Replace current stubbed sandbox execution with E2B API calls
3. Implement streaming UI for real-time code generation feedback
4. Add package installation capabilities

---

### 2. **Next.js AI Page Generator** (v0 Clone)
**GitHub**: https://github.com/cameronking4/nextjs-ai-page-generator

**Description**: Design, generate, iterate and live preview Next.js pages with GPT using Next, Prisma, OpenAI & Sandpack

**Key Features**:
- ✅ Live preview with Sandpack (CodeSandbox's browser bundler)
- ✅ GPT-powered UI generation
- ✅ Iterative chat-based code improvement
- ✅ Direct Next.js page generation

**Why Useful for MetaCoder**:
- Sandpack provides in-browser bundling (no backend needed)
- Chat-based iterative improvement matches our TaskForm UX
- Directly generates Next.js pages (can scaffold components)

**Integration Considerations**:
- Uses Sandpack instead of Vercel Sandbox (lighter weight)
- Requires Prisma for storage (we use Supabase - would need adapter)
- Focused on OpenAI (we support multiple AI agents)

---

### 3. **Sandbox by James Murdza**
**GitHub**: https://github.com/jamesmurdza/sandbox

**Description**: Cloud-based code editing environment with AI copilot, live preview, and real-time collaboration

**Key Features**:
- ✅ Custom AI code generation
- ✅ Live preview
- ✅ Real-time collaboration (WebSockets)
- ✅ AI chat integration
- ✅ Node.js backend + Next.js frontend

**Why Interesting for MetaCoder**:
- Real-time collaboration feature could enable team coding sessions
- WebSocket-based architecture for live updates
- Separate backend provides more control over execution

**Integration Challenges**:
- Requires separate Node.js backend (adds complexity)
- Would need to modify to support multiple AI agents
- Collaboration features may be overkill for current requirements

---

### 4. **Vercel AI SDK**
**GitHub**: https://github.com/vercel/ai
**Docs**: https://ai-sdk.dev/

**Description**: Official AI toolkit from Vercel for building AI-powered applications with TypeScript

**Key Features**:
- ✅ Unified API for multiple AI providers (OpenAI, Anthropic, Google, Mistral)
- ✅ Streaming responses
- ✅ Built-in React hooks (useChat, useCompletion)
- ✅ Edge runtime compatible
- ✅ Tool calling support

**Why Essential for MetaCoder**:
- **We should already be using this!**
- Unified interface for Claude Code, OpenAI Codex, Gemini
- Official Vercel integration
- Handles streaming natively
- Reduces boilerplate for AI agent switching

**Integration Priority**: HIGH
1. Install @ai-sdk/react, @ai-sdk/openai, @anthropic-ai/sdk
2. Replace direct API calls with AI SDK providers
3. Use `useChat` hook in TaskForm for streaming responses
4. Simplify agent switching logic

---

### 5. **Vercel AI Chatbot Template**
**GitHub**: https://github.com/vercel/ai-chatbot

**Description**: Full-featured, hackable Next.js AI chatbot with authentication, database, and streaming

**Key Features**:
- ✅ Complete authentication system
- ✅ Chat history persistence
- ✅ Multi-provider support
- ✅ Streaming UI
- ✅ Server actions

**Why Useful for Reference**:
- Production-ready architecture patterns
- Shows best practices for AI integration
- Has rate limiting and auth patterns we can copy
- Uses Postgres (similar to our Supabase setup)

---

## PWA-Specific Solutions

### **vite-pwa/vite-plugin-pwa**
**GitHub**: https://github.com/vite-pwa/vite-plugin-pwa

**Description**: Zero-config PWA plugin for Vite

**Use Case**: If we want to make MetaCoder Sandbox work offline or installable as a PWA

**Features**:
- Service worker generation
- Offline support
- App manifest
- Framework-agnostic

**Integration**: Add to Vite config (if we add Vite to our build pipeline)

---

### **shadowwalker/next-pwa**
**GitHub**: https://github.com/shadowwalker/next-pwa

**Description**: Zero config PWA plugin for Next.js with Workbox

**Use Case**: Make the entire GEO-SEO app installable as a PWA

**Features**:
- Automatic service worker generation
- Offline support
- App manifest
- Works with Next.js App Router

**Integration**: Simple Next.js config addition

---

## Recommendation: Implementation Plan

### Phase 1: Core AI Integration (Week 3)
1. **Install Vercel AI SDK** ⭐ PRIORITY
   ```bash
   npm install ai @ai-sdk/react @ai-sdk/openai @anthropic-ai/sdk
   ```

2. **Integrate E2B SDK for Secure Execution**
   ```bash
   npm install @e2b/sdk
   ```

3. **Update TaskForm.tsx**:
   - Replace fetch calls with `useChat` hook
   - Enable streaming responses
   - Add real-time log updates

### Phase 2: Enhanced Sandbox Features (Week 4)
4. **Add Sandpack for In-Browser Preview**
   ```bash
   npm install @codesandbox/sandpack-react
   ```

5. **Implement Live Preview** in LivePreview.tsx
   - Replace iframe with Sandpack component
   - Enable in-browser code execution
   - Add file tree synchronization

### Phase 3: PWA Features (Week 5+)
6. **Add PWA Support** with next-pwa
   - Make MetaCoder Sandbox installable
   - Enable offline code editing
   - Cache generated code locally

---

## Technical Architecture Comparison

### Current MetaCoder Sandbox:
```
TaskForm → API Route → Supabase → Manual Vercel Deploy
```

### With E2B Fragments Pattern:
```
TaskForm → AI SDK → E2B Sandbox → Real-time Stream → Live Preview
```

### With Sandpack Pattern:
```
TaskForm → AI SDK → File State → Sandpack Bundler → In-Browser Preview
```

---

## License Compatibility

All recommended projects use **MIT License** ✅ - fully compatible with commercial use

---

## Next Steps

1. ✅ Install Vercel AI SDK (enables multi-provider support)
2. ✅ Add E2B SDK for sandboxed execution
3. ✅ Implement streaming UI with useChat hook
4. ⏳ Test with Claude Code, OpenAI Codex, and Gemini
5. ⏳ Add Sandpack for in-browser preview
6. ⏳ Consider PWA features for offline support

---

## Resources

- **E2B Documentation**: https://e2b.dev/docs
- **Vercel AI SDK Docs**: https://sdk.vercel.ai/docs
- **Sandpack Docs**: https://sandpack.codesandbox.io/
- **Next-PWA Guide**: https://github.com/shadowwalker/next-pwa#readme

---

## Summary

**Best Fit**: Combine **Vercel AI SDK** (for multi-agent support) + **E2B SDK** (for secure execution) + **Sandpack** (for live preview)

This stack provides:
- ✅ Multi-AI agent support (Claude, GPT, Gemini)
- ✅ Secure code execution
- ✅ Real-time streaming
- ✅ In-browser preview
- ✅ No external deployment needed
- ✅ Production-ready architecture
